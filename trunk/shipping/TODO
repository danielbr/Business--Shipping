################################################################################
##  General TODO
################################################################################
 
 * [BUG] 'make test' generates these bugs:
    t/45_Offline-UPS..........Argument "Letter" isn't numeric in numeric eq (==) at /usr/lib/perl5/site_perl/5.8.3/SQL/Statement.pm line 1120, <GEN3> chunk 2.
    Argument "Multiplier" isn't numeric in numeric eq (==) at /usr/lib/perl5/site_perl/5.8.3/SQL/Statement.pm line 1120, <GEN3> chunk 153.

 * [DOC] Documentation Ehancements:
   Look into OODoc or Pod::Tree
   Use Pod::HtmlEasy to generate CPAN-style (i.e. pretty) HTML docs.
   Use podchecker during build process

 * [ENH] Restructure:
   - Keep everything the same, except the "lowest level":
         "Online::UPS"  => "UPS_Online"
	 "Offline::UPS" => "UPS_Offline"
	 "Online::USPS" => "USPS_Online"
	 new            => "UPS_Online_Old"
         Shipping::RateRequest::Online::UPS --> Shipping::UPS_Online::RateRequest
	 Shipping::Shipment::UPS --> Shipping::UPS_Online::Shipment
	 Shipping::RateRequest::Online::USPS --> Shipping::USPS_Online::RateRequest
   - Benefits:
     All of the vendor-related code is in one directory (UPS/, FedEx/, etc.).
     All of the abstract code is in neutral directories.
   - Optional: Move the neutral code to Shipping::All:: to signify the fact that
     all code is derived from them.
	 
 * [ENH] Remove default_package() and determine_shipper_from_self().

 * [ENH] Conform to coding style: private methods should be prefixed with an
   underscore. 
 
 * [ENH] Make some kind of allowance for alternate units (kilograms, etc.).

 * [ENH] Look into Params::Validate and/or Class::Contract
 
 * [ENH] Add Test::Inline tests

 * [ENH] Consider using Locale::Country (5.8.x+) & Locale::SubCountry (CPAN), or 
   Geography::States & Geography::Countries.

 * [DOC] Memory footprint information: 
   8+ MB when Offline is used (and stays).
   ---> 6.5 mb happens at the time of 
        "use Business::Shipping::RateRequest::Offline::UPS"
   ---> Which module is taking up 6.5mb memory?
   ---> At any rate, make a note for users of mod_perl to preload those modules
        once, instead of letting the runtime include load them for each
	process.

Yes, but it should only be loading the ones it needs (and then keeping them in
memory).  For example, if you do a shipment *from* a certain zip code,
it should load that zone file (e.g. 986.csv), then keep it in memory, so the
next request will be faster.

The internal representation is at least twice as big as the file is (probably
more).

I think that for regular usage (one origination, multiple destinations), the KB
of files actually used probably does not go over 500K.  So the memory used for
500K should only be 2MB or less.  Since you are seeing 8MB, I wonder where it
is coming from.

It could be a bug in my code (that really is loading more tables than it
should), or it could be the extra modules that the Offline::UPS uses.  But I
don't think so, they are pretty small: 

use Data::Dumper;
use File::Find;
use File::Copy;
use Math::BaseCnv;
use Scalar::Util 1.10;

Anyway, I think I need to investigate it some more.
 
   -  "optimize for smaller memory footprint"
   -  "or, optimize for execution speed (larger memory footprint)"

	If it is optimized for memory footprint, then it will read the table off the
	disk (getting a benefit from OS filesystem cache, probably), then convert it to
	the in-memory representation (hmm... I should save this internal representation
	next time), then run the calculation.

 * [ENH] Split the data into its own package, and add it to the bundle.
   - Business::Shipping::Data

 * [ENH] Logging system (Log4perl) enhancements
   - At the time of Makefile.PL, automatically transform the log4perl.conf file
     with the correct absolute path to 'log'.  Same problem as config.ini and
     the hard-coded path to /var/perl/Business-Shipping.
     
   - Find some way to have a "remove Business::Shipping" from the first part of 
     the name.  Probably a Log::Log4perl::Filter.    
 
 * [ENH] Use Log::Dispatch::Email for incident notifications?

 * [ENH] Make the error handling more customizable
   Each module should be able to specifiy it's parameters, so that, for example,
   you could have lots of debugging/errors for RateRequest::Offline, but none 
   for RateRequest::Online.
   
 * [ENH] How do I document the fact that some of the modules I require do not
   build very easily in CPAN?  Right now, it's:
     - SQL::Statement keeps trying to install, even after it is installed
	 - XML::Parser fails t/stream test 11.  
	 - XML::Parser::PerlSAX

 * [ENH] Allow error format to specified: With/without caller, line numbers.

 * [ENH] Evaluate fields.pm as a guard against autovivification. 
 
 * [ENH] Update to more recent C:MM syntax, like '-default', etc.
 
 * [ENH] Allow users to set path to support files.

 * [ENH] Need to check for support_files() config param, and exit if files
   are missing.

 * [ENH] Allow the user to set the timeout for http requests.  Sometimes 30
   seconds is too long.

 * [ENH] Evaluate Log4Perl.

 * [ENH] Is non-ssl communication with either Online provider possible?
 
 * [ENH] Migrate the "retry on failure" code from business-shipping.tag to 
   Business::Shipping proper.  Default to tries=2, but allow that to be
   overridden.  ("Failure" means HTTP 500 errors.)

 * [ENH] Business::Shipping::OldUPS
    - Doesn't require signup (no username/password, etc.)
    - Utilize the new Business::UPS 2.0.
 
 * [ENH] New, optional interface:
 
	use Business::Shipping;
	
	my $rate_request = Business::Shipping->rate_request(
		shipper 	=> 'all',
		to_zip 		=> '',
		from_zip	=> '',
	);
	
	my $results = $rate_request->submit() or die $rate_requet->error();
	
	foreach my $shipper ( $@results ) {
		print "Shipper Name: $shipper->{name}\n";
		
		foreach my $service ( $shipper->{ 'services' } ) {
			print "  Service: $service->{name}\n";
			print "  Price:   $service->{total_charges}\n";
		}
	}
	
 * [ENH] Additional module flexibility
	- Allow the use of Net::SSLeay as well as Crypt::SSLeay

 * [ENH] New feature ideas:
 	- Address Verification
	- Shipping status (package tracking)
	- Service Availability
	- Electronic Merchandise Return?
	- Shipping label generation?
	- Customs forms?
	- Shipping time (how long till it gets there)?
	- Delivery/Signature confirmation?

 * [ENH] Allow the user to enable one shipper as a secondary shipper, if the 
   first should fail.  For example, if the UPS/USPS servers are down, it will
   automatically utilize the table-lookup method.
   
 * [ENH] Many of the functions that are currently in 
   Shipping::RateRequest::Offline::UPS should probably be moved somewhere else.
   They work on one shipment at a time, and having them in the RateRequest 
   object makes it seem like they should be able to work on multiple shipments
   at once.  Perhaps make the first parameter the given shipment to be worked 
   on?
 
 * [ENH] Find or create some module that will automatically update the "=head1 
   VERSION" POD based on the CVS "Revision" keyword or the perl $VERSION 
   variable in the same file.
   
 * [DOC] Need to create a list of common errors that will be encountered.
 
 * [ENH] Change the many occurrences of $self->weight( 5 ) to 
   $self->set_weight( 5 ) (and their like) for readability.
 
 * [ENH] Setup a proper "announce", "cvs", and "users" mailing list where users
   can sign up for updates and get information.   
 
 * [ENH] Build a more advanced configuration system, with more config-file
   flexibility.
 
 * [ENH] [UNDER CONSIDERATION] Upgrade to Class::MethodMaker 2.00?
   - It does not support several features, like 'grouped_fields'.
   - It does not support grouped_fields_inherit
   - It is prettier.
 
 * [ENH] Test for thread-safety-ness.

 * [ENH] New feature for MethodMaker: parent_defaults => [ 'shipper' => 'UPS' ].
   After initialization, calls parent methods with default values so the user 
   does not have to write an "-init" method.

 * [ENH] Add support back in for multi-package API.
 
################################################################################
##  Online::USPS TODO
################################################################################

 * [BUG] Find a better way to correlate "Air mail" with all the various names
   it is called by each country.
 
 * [BUG] Not correctly realizing when there is an error (<Error><Number>...)
   - Perhaps because we don't ( KeepRoot => 1, ) on the XMLin()?

 * [ENH] Enable Cache for USPS.
 
 * [ENH] Support get_charges( 'service' ) for domestic types.

 * [ENH] Use the International Country Listing
	- http://pe.usps.gov/cpim/ftp/manuals/Imm/Immctry.pdf
 
################################################################################
##  Offline::UPS TODO
################################################################################

 * Get an alternate set of data for people who aren't on daily pickup.

 * [BUG] UPS Ground: Was 7.02.  Should have been 8.11, or 8.64.
   - See t/manual/offline_ups_bug2_al.pl
   - Offline is not handling the residential thing correctly, I think.
     "A delivery area surcharge of ___" (determined from accessorrials.csv)
     Currently: $1.75.
     Residential Differential: 1.40
   - REAL PROBLEM: It looks like I'm in zone 4, when I should be in zone 8!
     Are my zone/rate files up-to-date?

 * [ENH] Determine the upcoming fuel surcharge changes from UPS website, then 
   check to see if that date has passed.  If so, automatically update the fuel 
   surcharge.
   
   The surcharge also applies to the following accessorial charges (where 
   applicable):

    * On-Call Pickup Charges
    * UPS Next Day Air Early A.M./UPS Express Plus Charges
    * International Extended Area Charges
    * Remote Delivery Charges
    * Saturday Delivery
    * Saturday Pickup

 * [BUG] Note:  Effective January 5, 2004, the Fuel Surcharge will be 
   discontinued for the following services:  UPS Ground Commercial, UPS Ground 
   Residential, UPS Ground Hundredweight Service, and UPS Standard to Canada.
   
 * [BUG] United Kingdom Express Plus
   Error:  Zero cost returned for mode ExpressPlusSM, geo code (key) United 
   Kingdom.
        from_country =>                 'US',
        to_country =>           'UK',
        event_handlers =>               'HASH(0x9b8b5ac)',
        from_state =>           'WA',
        service =>              'XDM',
        from_zip =>             '98682',
        weight =>               '55',
        to_zip =>               'S11 9BU',
        cache =>                '1',
        shipper =>              'Offline::UPS',

 * [BUG] United Arab Emirates XPD:
   No zone found for geo code (key) United Arab Emirates, type ExpeditedSM_EC.
        from_country =>                 'US',
        to_country =>           'AE',
        event_handlers =>               'HASH(0x9bfbd60)',
        from_state =>           'WA',
        service =>              'XPD',
        from_zip =>             '98682',
        weight =>               '7',
        to_zip =>               '17295',
        cache =>                '1',
        shipper =>              'Offline::UPS',

 * [BUG] Saudi Arabia  
   Error:  No zone found for geo code (key) Saudi Arabia, type ExpeditedSM_EC.
        from_country =>                 'US',
        to_country =>           'SA',
        event_handlers =>               'HASH(0x9b1596c)',
        from_state =>           'WA',
        service =>              'XPD',
        from_zip =>             '98682',
        weight =>               '0.5',
        to_zip =>               '56232',
        cache =>                '1',
        shipper =>              'Offline::UPS',
 
 * St. Lucia
   Error:  No zone found for geo code (key) St. Lucia, type ExpeditedSM_EC.
        from_country =>                 'US',
        to_country =>           'LC',
        event_handlers =>               'HASH(0x9beec34)',
        from_state =>           'WA',
        service =>              'XPD',
        weight =>               '61',
        from_zip =>             '98682',
        to_zip =>               'none',
        shipper =>              'Offline::UPS',
        cache =>                '1',

 * [BUG] Jordan: 
   Error:  No zone found for geo code (key) Jordan, type ExpeditedSM_EC.
        from_country =>                 'US',
        to_country =>           'JO',
        event_handlers =>               'HASH(0x9b3a498)',
        from_state =>           'WA',
        service =>              'XPD',
        from_zip =>             '98682',
        weight =>               '3',
        to_zip =>               '13110',
        cache =>                '1',
        shipper =>              'Offline::UPS',

 * [BUG] Israel:
     No zone found for geo code (key) Israel, type ExpeditedSM_EC.
        from_country =>                 'US',
        to_country =>           'IL',
        event_handlers =>               'HASH(0x9aae31c)',
        from_state =>           'WA',
        service =>              'XPD',
        from_zip =>             '98682',
        weight =>               '5.5',
        to_zip =>               '79505',
        cache =>                '1',
        shipper =>              'Offline::UPS',

 * [BUG] Serbia:
        from_country =>         'US',
        to_country =>           'XS',
        from_state =>           'WA',
        service =>              'XDM',
        from_zip =>             '98682',
        weight =>               '2',
        to_zip =>               '564',
        cache =>                '1',
        shipper =>              'Offline::UPS',

 * [BUG] Error:  No zone found for geo code (key) 802, type Express.
        from_country =>         'US',
        to_country =>           'CA',
        from_state =>           'OR',
        service =>              'XPR',
        to_residential =>       '1',
        from_zip =>             '97214',
        weight =>               '1',
        to_zip =>               '80210',
        cache =>                '1',
        shipper =>              'Offline::UPS',

 * [BUG] Error:  No zone found for geo code (key) Cyprus, type ExpeditedSM_EC.
   Important variables:
        shipper =>      'Offline::UPS',
        service =>      'XPD',
        to_country =>   'CY',
        weight =>       '2',
        to_zip =>       '2024',

 * [BUG] France Metropolitan:
		[business-shipping]: Offline::UPS error: No zone found for geo code (key) France,
		Metropolitan, type ExpeditedSM_EC. .
		Options were: {'cache' => "1",'from_state' => "Washington",'from_zip' => "98682",'weight' =>
		"1.5",'to_zip' => "69100",'from_country' => "US",'shipper' => "Offline::UPS",'to_country' =>
		"FX",'service' => "XPD",}

 * [BUG] Canada via XPR/XPD doesn't work (and wont, until canada is implemented)
		[business-shipping]: Offline::UPS error: No zone found for geo code (key) Canada, type
		ExpeditedSM_EC. .
		Options were: {'cache' => "1",'from_state' => "Washington",'from_zip' => "98682",'weight' =>
		"1",'to_zip' => "h9h2v3",'from_country' => "US",'shipper' => "Offline::UPS",'to_country' =>
		"CA",'service' => "XPD",}
 * [BUG] 99663 = Seldovia, Alaska
		my $rate_request = Business::Shipping->rate_request(
                       shipper         => 'Online::UPS',
                       from_canada     => 'CA',
                       from_country    => 'CA',
                       from_zip        => 'v6h3y8',
                       to_country      => 'US',
                       to_zip          => '99663',
                       weight          =>  5.00,
                       user_id         => 'userid',
                       password        => 'pass',
                       service         => 'XPD',
                       access_key       => 'XXXXXX',
               );


				
 * [ENH] Confirm that the auto-update feature works well.
 
 * [ENH] Performance enhancement: instead of transforming the data with
   calc_zone_data() everytime, just re-write the data file.
 
 * [DOC] Refer to Express for Express Plus.  To determine whether Express Plus
   service is available to your destination postal code, call 800-782-7892.

 * Analyze the 'extra services fees' table:
   - Extended/Domestic Area Surcharge:  Residential = 1.75, Commercial= 1.00
   - Residential Surcharge = 1.40 (always assume yes, unless explicitly stated
     no).
 
 * [ENH] Allow user to specify "use default" for Makefile.PL (already done?)
 
 * [ENH] Change from_state to a Shipment function, which will calculate and set 
   the is_from_west_coast() value, instead of doing from within 
   massage_values().

 * [ENH] Have a simple example script in the doc directory.

 * [ENH] How to find the current fuel surcharge rate:
   - http://www.ups.com/content/us/en/resources/find/cost/fuel_surcharge.html	
   - m/Effective.+: ?(\d\.\d\d\)%/
   
 * [ENH] Extended Area Surcharge: 
   - http://www.ups.com/media/en/extended_area_us.pdf
   
 * [ENH] Modify the system so that the easy-to-read data is read into memory
         just once, and then is optimized for lookup speed, so the sequential
		 lookups will be as fast as possible.  (Increases memory footprint, but
		 it should be worth it).
 
 * [ENH] Canada needs to check for EAS surcharge (see canww.csv->'EAS' column)
 
 * [ENH] Add support for Canada (UPS Standard, XPD, XPR, XDM)
         - Requires new parsing method (Canada ZIP style, etc.)

 * [ENH] Add test for the support files directory.  (Just warn, because they 
         may be running the test as a non-priveledged user).
 
 * [ENH] Re-write the calc_zone_data() and calc_cost() routines.

 * [ENH] New table design?

		zone table:
		
 			zone_from_exactly	zone_from_lt	zone_from_gt	zip_to_exactly	zip_to_lt	zip_to_gt	service
		
		weight table:
		
			weight	zone	amt

 * [ENH] Add tests for Alaska, Hawaii, Canada, and International.
         Add tests for 1DAP.

 * [ENH] Look at the zone file comments to determine which zone file to use.
   (i.e. 970.csv has "970-01 to 972-99" -- means it actually does 972.csv too).
 
 * [ENH] Utilize GDBM or SQL, if available, to speed up lookups.

################################################################################
##  Online::UPS TODO
################################################################################
 
 * [BUG] Fix the multi-package API for UPS.  
   # TODO: Move to a different XML generation scheme, since all the packages 
   #       in a multi-package shipment will have the name "Package".
   # TODO: multi-package support: loop over the packages
   
 * [BUG] Return error message if trying to ship to military americas:
   - USP does not ship to APO or FPO addresses.

 * [BUG] Be able to handle "mal-formed XML doc" error return from UPS.  
 	- Right now, it still tries to parse as an XML doc.

 * [ENH] Allow better names, like "One Day Air" instead of 1DA.
   - Better names for packaging too (instead of numbers).
 
 * [ENH] UPS support for sending multiple simultaneous requests
	- (USPS had built-in support in the API for Intl)
 	- If they don't support it, try LWP::Parallel::UserAgent.
	
################################################################################
##  Interchange UserTag TODO
################################################################################

 * [ENH] Test for ability to use within Safe?
   Remove runtime requires: Business::Shipping->rate_request( ... )
   
################################################################################
##  Online::FedEx 
################################################################################
		 
 * [ENH] FedEx module: Christopher L Wenham from Synesmedia has created an 
   Interchange usertag that uses FedEx::DirectConnect for various functions.  
   Evaluate.
